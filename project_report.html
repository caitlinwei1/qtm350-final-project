<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Amanda Yang (2512275), Caitlin Wei (2551023), Max Jiang (2547409), Angela Xie (2515217)">
<meta name="dcterms.date" content="2024-12-08">

<title>How Economic Development and Educational Attainment Impact Female Fertility Rate: A Regression Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="project_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="project_report_files/libs/quarto-html/quarto.js"></script>
<script src="project_report_files/libs/quarto-html/popper.min.js"></script>
<script src="project_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="project_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="project_report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">How Economic Development and Educational Attainment Impact Female Fertility Rate: A Regression Approach</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Amanda Yang (2512275), Caitlin Wei (2551023), Max Jiang (2547409), Angela Xie (2515217) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 8, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Female fertility rate is a vital indicator of societal development, reflecting not only population trends but also the economic, educational, and cultural contexts within a country. In today’s fast-paced, competitive world, women’s willingness and ability to give birth and raise children are profoundly influenced by advancements in economic development and educational attainment. Investigating these factors provides crucial insights into how nations can balance their growth trajectories with population stability, gender equity, and cultural sustainability.</p>
<p>This research explores the relationship between economic development, educational achievement, and female fertility rates, focusing on two key indicators: adolescent fertility (ages 15-19) and total fertility rate (births per woman). These metrics serve as proxies for women’s reproductive decisions and societal attitudes towards childbearing. On the other hand, GDP per capita and school enrollment rates at the primary, secondary, and tertiary levels represent key dimensions of economic and educational progress.</p>
<p>Using data from the World Bank, our group aims to construct a multivariable regression model to examine how economic development and educational attainment influence fertility rates across countries in four world regions: Eastern and Southern Africa, North America, East Asia &amp; Pacific, and the European Union. In this model, GDP per capita and school enrollment at all levels will serve as explanatory variables, while adolescent fertility and total fertility rates will be the dependent variables. This approach will allow us to quantify the extent to which economic prosperity and education drive changes in fertility patterns globally.</p>
<p>Insights from this study is critical for policymakers, as fertility rates affect labor markets, public health, and long-term demographic trends. This research contributes to a deeper understanding of how societies can navigate the challenges of development while supporting women’s empowerment and well-being.</p>
</section>
<section id="data-description" class="level1">
<h1>Data Description</h1>
<p>We selected six variables from the World Bank open database: Adolescent fertility rate (births per 1,000 women ages 15-19), Fertility rate, total (births per woman), School enrollment, tertiary (% gross), School enrollment, secondary (% gross), School enrollment, primary (% gross), and GDP per capita (current US$).</p>
<section id="adolescent-fertility-rate" class="level2">
<h2 class="anchored" data-anchor-id="adolescent-fertility-rate">Adolescent Fertility Rate</h2>
<p>Adolescent fertility rate is the number of births per 1,000 women aged 15-19, providing a critical indicator of reproductive health and societal factors influencing early childbearing. Derived from vital registration systems, censuses, or surveys, it reflects access to education, contraception, and healthcare, with implications for maternal and child well-being in developing and developed regions.</p>
</section>
<section id="fertility-rate-total" class="level2">
<h2 class="anchored" data-anchor-id="fertility-rate-total">Fertility Rate, Total</h2>
<p>Total fertility rate represents the average number of children a woman would bear during her lifetime if age-specific fertility rates remained constant. It is derived from vital registration systems, censuses, or surveys and reflects societal factors influencing reproduction, including economic conditions, healthcare, and women’s access to education and family planning.</p>
</section>
<section id="tertiary-school-enrollment" class="level2">
<h2 class="anchored" data-anchor-id="tertiary-school-enrollment">Tertiary School Enrollment</h2>
<p>Female tertiary school enrollment (% gross) measures the gross enrollment ratio of female students in tertiary education as a percentage of the relevant age group population. Tertiary education generally encompasses programs beyond secondary school and may or may not lead to advanced research qualifications. Admission typically requires completing secondary education as a prerequisite. This indicator reflects women’s access to higher education and is shaped by educational policies, cultural values, and economic factors. Data is standardized using UNESCO methodologies.</p>
</section>
<section id="secondary-school-enrollment" class="level2">
<h2 class="anchored" data-anchor-id="secondary-school-enrollment">Secondary School Enrollment</h2>
<p>School Enrollment, Secondary, Female (% gross) measures the total female enrollment in secondary education as a percentage of the population of the age group officially corresponding to that education level. Secondary education completes the provision of basic education that began at the primary level, and aims at laying the foundations for lifelong learning and human development, by offering more subject- or skill-oriented instruction using more specialized teachers. Data is standardized using UNESCO methodologies.</p>
</section>
<section id="primary-school-enrollment" class="level2">
<h2 class="anchored" data-anchor-id="primary-school-enrollment">Primary School Enrollment</h2>
<p>School Enrollment, Primary, Female (% gross) measures the gross enrollment ratio of female students in primary education as a percentage of the relevant age group population. Primary education provides children with basic reading, writing, and mathematics skills along with an elementary understanding of such subjects as history, geography, natural science, social science, art, and music. Data is standardized using UNESCO methodologies.</p>
</section>
<section id="gdp-per-capita" class="level2">
<h2 class="anchored" data-anchor-id="gdp-per-capita">GDP Per Capita</h2>
<p>GDP per capita is calculated by dividing the gross domestic product (GDP) by the midyear population. GDP represents the total gross value added by all resident producers in the economy, including product taxes, and excluding subsidies not factored into product values. It does not account for depreciation of manufactured assets or the depletion and degradation of natural resources. The data are expressed in current U.S. dollars.</p>
</section>
</section>
<section id="data-analysis" class="level1">
<h1>Data Analysis</h1>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<p>We used both SQL and Python in our data cleaning process.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is quoted code and won't run</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>csv_file <span class="op">=</span> <span class="st">'/Users/yangziyu/Desktop/QTM 350/final_project/qtm350-final-project/data/WBData.csv'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(csv_file)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>create_table <span class="op">=</span> <span class="st">"CREATE TABLE wb_data (</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    col_name <span class="op">=</span> col.replace(<span class="st">" "</span>, <span class="st">"_"</span>).replace(<span class="st">"["</span>, <span class="st">""</span>).replace(<span class="st">"]"</span>, <span class="st">""</span>).replace(<span class="st">"."</span>, <span class="st">"_"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    dtype <span class="op">=</span> <span class="st">"REAL"</span> <span class="cf">if</span> pd.api.types.is_numeric_dtype(df[col]) <span class="cf">else</span> <span class="st">"TEXT"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    create_table <span class="op">+=</span> <span class="ss">f"    </span><span class="sc">{</span>col_name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>dtype<span class="sc">}</span><span class="ss">,</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>create_table <span class="op">=</span> create_table.rstrip(<span class="st">",</span><span class="ch">\n</span><span class="st">"</span>) <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">);"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>insert_statements <span class="op">=</span> []</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> <span class="st">", "</span>.join([<span class="ss">f"'</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">'"</span> <span class="cf">if</span> pd.notna(x) <span class="cf">else</span> <span class="st">"NULL"</span> <span class="cf">for</span> x <span class="kw">in</span> row])</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    insert_statements.append(<span class="ss">f"INSERT INTO wb_data VALUES (</span><span class="sc">{</span>values<span class="sc">}</span><span class="ss">);"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sql_script <span class="op">=</span> create_table <span class="op">+</span> <span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(insert_statements)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"wb_data.sql"</span>, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    f.write(sql_script)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SQL script saved to wb_data.sql"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># This is quoted code and won't run</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.datasets</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.dataframe <span class="im">as</span> dd</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask_sql <span class="im">import</span> Context</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Context()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> dd.read_csv(<span class="st">"/Users/maxjiang/Desktop/WBData.csv"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>c.create_table(<span class="st">"wb_data"</span>, df)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"SELECT * FROM wb_data"</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> c.sql(query)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># This is quoted code and won't run</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.dataframe <span class="im">as</span> dd</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask_sql <span class="im">import</span> Context</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Context()</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> dd.read_csv(<span class="st">"/Users/maxjiang/Desktop/WBData.csv"</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>c.create_table(<span class="st">"wb_data"</span>, df)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="op">=</span> [</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Country Name"</span>, <span class="st">"Series Name"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1975 [YR1975]"</span>, <span class="st">"1976 [YR1976]"</span>, <span class="st">"2020 [YR2020]"</span>, <span class="st">"2021 [YR2021]"</span>, <span class="st">"2022 [YR2022]"</span>, <span class="st">"2023 [YR2023]"</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> df[selected_columns]</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> filtered_df.rename(</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>{</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1974 [YR1974]"</span>: <span class="st">"Year1974"</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1975 [YR1975]"</span>: <span class="st">"Year1975"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1976 [YR1976]"</span>: <span class="st">"Year1976"</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1977 [YR1977]"</span>: <span class="st">"Year1977"</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1978 [YR1978]"</span>: <span class="st">"Year1978"</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1979 [YR1979]"</span>: <span class="st">"Year1979"</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1980 [YR1980]"</span>: <span class="st">"Year1980"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1981 [YR1981]"</span>: <span class="st">"Year1981"</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1982 [YR1982]"</span>: <span class="st">"Year1982"</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1983 [YR1983]"</span>: <span class="st">"Year1983"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1984 [YR1984]"</span>: <span class="st">"Year1984"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1985 [YR1985]"</span>: <span class="st">"Year1985"</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1986 [YR1986]"</span>: <span class="st">"Year1986"</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1987 [YR1987]"</span>: <span class="st">"Year1987"</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1988 [YR1988]"</span>: <span class="st">"Year1988"</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1989 [YR1989]"</span>: <span class="st">"Year1989"</span>,</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1990 [YR1990]"</span>: <span class="st">"Year1990"</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1991 [YR1991]"</span>: <span class="st">"Year1991"</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1992 [YR1992]"</span>: <span class="st">"Year1992"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1993 [YR1993]"</span>: <span class="st">"Year1993"</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1994 [YR1994]"</span>: <span class="st">"Year1994"</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1995 [YR1995]"</span>: <span class="st">"Year1995"</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1996 [YR1996]"</span>: <span class="st">"Year1996"</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1997 [YR1997]"</span>: <span class="st">"Year1997"</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1998 [YR1998]"</span>: <span class="st">"Year1998"</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1999 [YR1999]"</span>: <span class="st">"Year1999"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2000 [YR2000]"</span>: <span class="st">"Year2000"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2001 [YR2001]"</span>: <span class="st">"Year2001"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2002 [YR2002]"</span>: <span class="st">"Year2002"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2003 [YR2003]"</span>: <span class="st">"Year2003"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2004 [YR2004]"</span>: <span class="st">"Year2004"</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2005 [YR2005]"</span>: <span class="st">"Year2005"</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2006 [YR2006]"</span>: <span class="st">"Year2006"</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2007 [YR2007]"</span>: <span class="st">"Year2007"</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2008 [YR2008]"</span>: <span class="st">"Year2008"</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2009 [YR2009]"</span>: <span class="st">"Year2009"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2010 [YR2010]"</span>: <span class="st">"Year2010"</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2011 [YR2011]"</span>: <span class="st">"Year2011"</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2012 [YR2012]"</span>: <span class="st">"Year2012"</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2013 [YR2013]"</span>: <span class="st">"Year2013"</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2014 [YR2014]"</span>: <span class="st">"Year2014"</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2015 [YR2015]"</span>: <span class="st">"Year2015"</span>,</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2016 [YR2016]"</span>: <span class="st">"Year2016"</span>,</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2017 [YR2017]"</span>: <span class="st">"Year2017"</span>,</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2018 [YR2018]"</span>: <span class="st">"Year2018"</span>,</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2019 [YR2019]"</span>: <span class="st">"Year2019"</span>,</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2020 [YR2020]"</span>: <span class="st">"Year2020"</span>,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2021 [YR2021]"</span>: <span class="st">"Year2021"</span>,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2022 [YR2022]"</span>: <span class="st">"Year2022"</span>,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2023 [YR2023]"</span>: <span class="st">"Year2023"</span>,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> filtered_df.replace(<span class="st">".."</span>, <span class="va">None</span>)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>year_columns <span class="op">=</span> [</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year1974"</span>, <span class="st">"Year1975"</span>, </span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year1976"</span>, <span class="st">"Year1977"</span>, <span class="st">"Year1978"</span>, <span class="st">"Year1979"</span>, <span class="st">"Year1980"</span>, <span class="st">"Year1981"</span>, </span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year1982"</span>, <span class="st">"Year1983"</span>, <span class="st">"Year1984"</span>, <span class="st">"Year1985"</span>, <span class="st">"Year1986"</span>, <span class="st">"Year1987"</span>, </span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year1988"</span>, <span class="st">"Year1989"</span>, <span class="st">"Year1990"</span>, <span class="st">"Year1991"</span>, <span class="st">"Year1992"</span>, <span class="st">"Year1993"</span>, </span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year1994"</span>, <span class="st">"Year1995"</span>, <span class="st">"Year1996"</span>, <span class="st">"Year1997"</span>, <span class="st">"Year1998"</span>, <span class="st">"Year1999"</span>, </span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year2000"</span>, <span class="st">"Year2001"</span>, <span class="st">"Year2002"</span>, <span class="st">"Year2003"</span>, <span class="st">"Year2004"</span>, <span class="st">"Year2005"</span>, </span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year2006"</span>, <span class="st">"Year2007"</span>, <span class="st">"Year2008"</span>, <span class="st">"Year2009"</span>, <span class="st">"Year2010"</span>, <span class="st">"Year2011"</span>, </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year2012"</span>, <span class="st">"Year2013"</span>, <span class="st">"Year2014"</span>, <span class="st">"Year2015"</span>, <span class="st">"Year2016"</span>, <span class="st">"Year2017"</span>, </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year2018"</span>, <span class="st">"Year2019"</span>, <span class="st">"Year2020"</span>, <span class="st">"Year2021"</span>, <span class="st">"Year2022"</span>, <span class="st">"Year2023"</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> year_columns</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(year_columns):</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">2</span>:  </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        prev1, prev2 <span class="op">=</span> year_columns[i <span class="op">-</span> <span class="dv">1</span>], year_columns[i <span class="op">-</span> <span class="dv">2</span>]</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>        query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="ss">            UPDATE wb_data_cleaned</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="ss">            SET `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` = COALESCE(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`, (`</span><span class="sc">{</span>prev1<span class="sc">}</span><span class="ss">` + `</span><span class="sc">{</span>prev2<span class="sc">}</span><span class="ss">`) / 2)</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="ss">            WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NULL;</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a><span class="ss">        """</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>        c.sql(query)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> year_columns:</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="ss">        UPDATE wb_data_cleaned</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a><span class="ss">        SET `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` = COALESCE(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`, </span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="ss">            (SELECT AVG(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`) FROM wb_data_cleaned WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NOT NULL))</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NULL;</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    c.sql(query)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">"Country Name"</span>, <span class="st">"Series Name"</span>]</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="ss">        UPDATE wb_data_cleaned</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="ss">        SET `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` = COALESCE(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`, </span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="ss">            (SELECT `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` FROM wb_data_cleaned </span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a><span class="ss">             GROUP BY `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` ORDER BY COUNT(*) DESC LIMIT 1))</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NULL;</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>    c.sql(query)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    filtered_df[col] <span class="op">=</span> filtered_df[col].map_partitions(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_missing_values(df):</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"Year2022"</span>] <span class="op">=</span> df[<span class="st">"Year2022"</span>].fillna((df[<span class="st">"Year2020"</span>] <span class="op">+</span> df[<span class="st">"Year2021"</span>]) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"Year2023"</span>] <span class="op">=</span> df[<span class="st">"Year2023"</span>].fillna((df[<span class="st">"Year2021"</span>] <span class="op">+</span> df[<span class="st">"Year2022"</span>]) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>filled_df <span class="op">=</span> filtered_df.map_partitions(fill_missing_values)</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>c.create_table(<span class="st">"wb_data_Further_cleaned"</span>, filled_df)</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>filled_df.compute().to_csv(<span class="st">"/Users/maxjiang/Desktop/WBData_Further_Cleaned.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="co">#Improved Version</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.dataframe <span class="im">as</span> dd</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask_sql <span class="im">import</span> Context</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> Context()</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> dd.read_csv(<span class="st">"/Users/maxjiang/Desktop/WBData.csv"</span>)</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>c.create_table(<span class="st">"wb_data"</span>, df)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>year_columns <span class="op">=</span> [<span class="ss">f"Year</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1970</span>, <span class="dv">2020</span>)]</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>rename_mapping <span class="op">=</span> {<span class="ss">f"</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss"> [YR</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">]"</span>: <span class="ss">f"Year</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1970</span>, <span class="dv">2020</span>)}</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>rename_mapping.update({<span class="st">"Country Name"</span>: <span class="st">"CountryName"</span>, <span class="st">"Series Name"</span>: <span class="st">"SeriesName"</span>})</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> df.rename(columns<span class="op">=</span>rename_mapping)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> filtered_df.replace(<span class="st">".."</span>, <span class="va">None</span>)</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> year_columns</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    filtered_df[col] <span class="op">=</span> filtered_df[col].map_partitions(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_missing_values(df):</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(year_columns):</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="dv">2</span>:</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>            prev1, prev2 <span class="op">=</span> year_columns[i <span class="op">-</span> <span class="dv">1</span>], year_columns[i <span class="op">-</span> <span class="dv">2</span>]</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>            df[col] <span class="op">=</span> df[col].fillna((df[prev1] <span class="op">+</span> df[prev2]) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>filled_df <span class="op">=</span> filtered_df.map_partitions(fill_missing_values)</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a><span class="ss">        UPDATE wb_data_cleaned</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a><span class="ss">        SET `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` = COALESCE(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`, </span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a><span class="ss">            (SELECT AVG(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`) FROM wb_data_cleaned WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NOT NULL))</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NULL;</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>    c.sql(query)</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">"CountryName"</span>, <span class="st">"SeriesName"</span>]</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a><span class="ss">        UPDATE wb_data_cleaned</span></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a><span class="ss">        SET `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` = COALESCE(`</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">`, </span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a><span class="ss">            (SELECT `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` FROM wb_data_cleaned </span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a><span class="ss">             GROUP BY `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` ORDER BY COUNT(*) DESC LIMIT 1))</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE `</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">` IS NULL;</span></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    c.sql(query)</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>filled_df.compute().to_csv(<span class="st">"/Users/maxjiang/Desktop/WBData_Further_Cleaned.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a><span class="co">#Final Check using Python</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a><span class="co">correct_file_path = '/Users/maxjiang/Desktop/WBData.csv'</span></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a><span class="co">data = pd.read_csv(correct_file_path)</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a><span class="co">data.columns = [col.strip().replace(' [', '_').replace(']', '').replace('YR', 'Year') for col in data.columns]</span></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a><span class="co">data.replace("..", pd.NA, inplace=True)</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a><span class="co">for col in data.columns[5:]:  # Assuming first 5 columns are non-numeric metadata</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a><span class="co">    data[col] = pd.to_numeric(data[col], errors='coerce')</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a><span class="co">years = [col for col in data.columns if 'Year' in col]</span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a><span class="co">recent_years_average = data[years[-2:]].mean(axis=1, skipna=True)</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a><span class="co">for col in years:</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a><span class="co">    data[col] = data[col].fillna(recent_years_average)</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a><span class="co">output_corrected_path = '/Users/maxjiang/Desktop/WBData_Cleaned.csv'</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a><span class="co">data.to_csv(output_corrected_path, index=False)</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a><span class="co">for row_index in [8, 9]:  # 9th and 10th rows (zero-based index)</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a><span class="co">    row_last_two = data.iloc[row_index][years[-2:]]</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a><span class="co">    if row_last_two.isnull().all():</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a><span class="co">        overall_average = data.iloc[row_index][years].mean(skipna=True)</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a><span class="co">        data.loc[row_index, years[-2:]] = overall_average</span></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a><span class="co">data.to_csv(output_corrected_path, index=False)</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a><span class="co">updated_rows = data.iloc[[8, 9]][years[-2:]]</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a><span class="co">updated_rows</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="co">row_index = 8  </span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="co">row_last_two = data.iloc[row_index][years[-2:]]</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a><span class="co">if row_last_two.isnull().all():</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a><span class="co">    overall_average = data.iloc[row_index][years].mean(skipna=True)</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a><span class="co">    data.loc[row_index, years[-2:]] = overall_average</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a><span class="co">data.to_csv(output_corrected_path, index=False)</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a><span class="co">updated_ninth_row_last_two = data.iloc[row_index][years[-2:]]</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a><span class="co">updated_ninth_row_last_two</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a><span class="co">previous_two_years = years[-4:-2]</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a><span class="co">previous_two_years_average = data.loc[row_index, previous_two_years].mean(skipna=True)</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a><span class="co">data.loc[row_index, years[-2:]] = previous_two_years_average</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a><span class="co">data.to_csv(output_corrected_path, index=False)</span></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a><span class="co">corrected_ninth_row_last_two = data.loc[row_index, years[-2:]]</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a><span class="co">corrected_ninth_row_last_two</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a><span class="co">columns_to_remove = ['Series Code', 'Country Code']</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a><span class="co">data.drop(columns=columns_to_remove, inplace=True, errors='ignore')</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a><span class="co">data.columns = [col.split('_')[-1] if 'Year' in col else col for col in data.columns]</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a><span class="co">output_further_cleaned_path = '/Users/maxjiang/Desktop/WBData_Further_Cleaned.csv'</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a><span class="co">data.to_csv(output_further_cleaned_path, index=False)</span></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>By completing the steps above, we have ensured that the dataset <span class="kw">is</span> clean, consistent, <span class="kw">and</span> ready <span class="cf">for</span> analysis. The careful handling of missing values <span class="kw">and</span> renaming of columns enhances both the usability <span class="kw">and</span> interpretability of the data. With a complete <span class="dv">50</span><span class="op">-</span>year timespan <span class="kw">and</span> six well<span class="op">-</span>defined variables, including fertility metrics <span class="kw">and</span> regional categorizations (Eastern <span class="kw">and</span> Southern Africa, North America, East Asia <span class="op">&amp;</span> Pacific, <span class="kw">and</span> the EU), the dataset provides a solid foundation <span class="cf">for</span> exploring meaningful patterns <span class="kw">and</span> conducting robust statistical analysis.</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a><span class="co">## Summary Statistics</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a><span class="co">### Summary Statistics By Region</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>::: {<span class="co">#d90b9ba6 .cell execution_count=1}</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>``` {.python .cell<span class="op">-</span>code}</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the CSV file into a Pandas DataFrame</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">"/Users/yangziyu/Desktop/QTM 350/final_project/qtm350-final-project/data/data_for_sql.csv"</span>  <span class="co"># Replace with your file path</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(file_path)</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an SQLite database (or connect to an existing one)</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data1.db"</span>)  </span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the DataFrame into an SQL table</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>data.to_sql(<span class="st">"data_table"</span>, conn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the table content</span></span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"SELECT * FROM data_table LIMIT 5;"</span></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> pd.read_sql_query(query, conn)</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample_data.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Region  Year  adolescent_fertility  \
0  Africa Eastern and Southern  1974            152.504673   
1  Africa Eastern and Southern  1975            151.867914   
2  Africa Eastern and Southern  1976            150.533609   
3  Africa Eastern and Southern  1977            148.931096   
4  Africa Eastern and Southern  1978            146.644103   

   Fertility rate, total (births per woman)  gdp_per_capita  \
0                                  6.820429      421.977185   
1                                  6.805172      435.977902   
2                                  6.785995      430.261244   
3                                  6.767943      468.301007   
4                                  6.750403      509.479882   

   school_enrollment_primary  school_enrollment_secondary  \
0                  65.155342                    17.703409   
1                  67.497803                    18.236691   
2                  68.989937                    18.696880   
3                  70.836258                    19.130159   
4                  71.924622                    19.723339   

   school_enrollment_tertiary  
0                     1.95049  
1                     1.99506  
2                     2.02551  
3                     2.05232  
4                     2.12988  </code></pre>
</div>
<p>:::</p>
<div id="7dd71b10" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>query1 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">    "Region",</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT("adolescent_fertility") AS count_observations,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("adolescent_fertility") AS avg_adolescent_fertility,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">    MIN("adolescent_fertility") AS min_adolescent_fertility,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">    MAX("adolescent_fertility") AS max_adolescent_fertility,</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("gdp_per_capita") AS avg_gdp_per_capita,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("school_enrollment_primary") AS avg_primary_enrollment,</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("school_enrollment_secondary") AS avg_secondary_enrollment,</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("school_enrollment_tertiary") AS avg_tertiary_enrollment</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">FROM data_table</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY "Region";</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute the query and fetch results</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="op">=</span> pd.read_sql_query(query1, conn)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>summary_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">count_observations</th>
<th data-quarto-table-cell-role="th">avg_adolescent_fertility</th>
<th data-quarto-table-cell-role="th">min_adolescent_fertility</th>
<th data-quarto-table-cell-role="th">max_adolescent_fertility</th>
<th data-quarto-table-cell-role="th">avg_gdp_per_capita</th>
<th data-quarto-table-cell-role="th">avg_primary_enrollment</th>
<th data-quarto-table-cell-role="th">avg_secondary_enrollment</th>
<th data-quarto-table-cell-role="th">avg_tertiary_enrollment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Africa Eastern and Southern</td>
<td>50</td>
<td>123.659179</td>
<td>94.688181</td>
<td>152.504673</td>
<td>989.952961</td>
<td>86.117031</td>
<td>30.448847</td>
<td>4.896809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>East Asia &amp; Pacific</td>
<td>50</td>
<td>27.250583</td>
<td>20.101836</td>
<td>39.598045</td>
<td>5103.408136</td>
<td>108.536252</td>
<td>64.249117</td>
<td>21.045803</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>European Union</td>
<td>50</td>
<td>18.515741</td>
<td>9.066463</td>
<td>36.541219</td>
<td>20890.010973</td>
<td>102.800165</td>
<td>98.799087</td>
<td>47.379110</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>North America</td>
<td>50</td>
<td>39.815799</td>
<td>14.375896</td>
<td>57.855551</td>
<td>35286.638374</td>
<td>100.923277</td>
<td>95.774863</td>
<td>73.226633</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Based on the summary statistics above, we can see that Africa Eastern and Southern generally have higher adolescent fertility, lower gdp per capital and education enrollment compared to other regions.</p>
<section id="trend-of-female-fertility-rate-by-year" class="level3">
<h3 class="anchored" data-anchor-id="trend-of-female-fertility-rate-by-year">Trend of Female Fertility Rate by Year</h3>
<div id="9465a833" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>query2 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">    "Year",</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("adolescent_fertility") AS avg_adolescent_fertility</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM data_table</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY "Year"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY avg_adolescent_fertility ASC;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute the query and fetch results</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>summary_stats1 <span class="op">=</span> pd.read_sql_query(query2, conn)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>summary_stats1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">avg_adolescent_fertility</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2022</td>
<td>34.558094</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2023</td>
<td>34.558094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2021</td>
<td>35.210953</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2020</td>
<td>35.593976</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2019</td>
<td>36.338364</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2018</td>
<td>36.693597</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2017</td>
<td>37.727974</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2016</td>
<td>38.864585</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2015</td>
<td>40.097494</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2014</td>
<td>41.525873</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2013</td>
<td>42.311942</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2012</td>
<td>43.514744</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2011</td>
<td>44.491732</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2010</td>
<td>45.478098</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2009</td>
<td>46.511333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>2006</td>
<td>47.238232</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>2005</td>
<td>47.274225</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>2007</td>
<td>47.274647</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>2008</td>
<td>47.421004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>2004</td>
<td>47.696507</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>2003</td>
<td>48.225742</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>2002</td>
<td>49.334682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>2001</td>
<td>50.536227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>2000</td>
<td>51.100895</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>1999</td>
<td>51.845482</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>1998</td>
<td>51.954309</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>1997</td>
<td>52.734165</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>1996</td>
<td>54.478990</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>1995</td>
<td>55.227043</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>1994</td>
<td>56.726343</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>1993</td>
<td>58.459834</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>1992</td>
<td>59.049802</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>1988</td>
<td>60.434924</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>1987</td>
<td>60.516948</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>1986</td>
<td>60.584687</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>1989</td>
<td>60.730916</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>1991</td>
<td>61.307059</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>1985</td>
<td>61.467961</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>1990</td>
<td>61.952906</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>1984</td>
<td>62.074267</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>1983</td>
<td>62.629157</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>1981</td>
<td>62.792716</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>1980</td>
<td>63.200984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>1982</td>
<td>63.486551</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>1979</td>
<td>63.783899</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>1978</td>
<td>65.039899</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>1977</td>
<td>67.047197</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>1976</td>
<td>68.273405</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>1975</td>
<td>69.465068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>1974</td>
<td>70.672741</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The adolescent_fertility generally descrease over time on average.</p>
</section>
<section id="gdp-growth-by-region" class="level3">
<h3 class="anchored" data-anchor-id="gdp-growth-by-region">GDP Growth by Region</h3>
<div id="aa6fff52" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>query3 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">    "Region",</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG("gdp_per_capita") AS avg_gdp_per_capita,</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">    MAX("gdp_per_capita") - MIN("gdp_per_capita") AS gdp_growth</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM data_table</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY "Region"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY gdp_growth DESC;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute the query and fetch results</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>summary_stats2 <span class="op">=</span> pd.read_sql_query(query3, conn)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>summary_stats2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">avg_gdp_per_capita</th>
<th data-quarto-table-cell-role="th">gdp_growth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>North America</td>
<td>35286.638374</td>
<td>71466.380836</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>European Union</td>
<td>20890.010973</td>
<td>37143.177577</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>East Asia &amp; Pacific</td>
<td>5103.408136</td>
<td>12529.099105</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Eastern and Southern</td>
<td>989.952961</td>
<td>1336.021219</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The findings highlight significant economic disparities, with North America and the European Union leading in GDP per capita and growth, while Africa Eastern and Southern lags far behind.</p>
</section>
</section>
<section id="data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="data-visualization">Data Visualization</h2>
<div id="16ae03e4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">"/Users/yangziyu/Desktop/QTM 350/final_project/qtm350-final-project/data/WBData_Further_Cleaned.csv"</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(file_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-ado-fer-line" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> data[data[<span class="st">'Series Name'</span>] <span class="op">==</span> <span class="st">'Adolescent fertility rate (births per 1,000 women ages 15-19)'</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for plotting</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> filtered_data.drop(columns<span class="op">=</span>[<span class="st">'Series Name'</span>]).set_index(<span class="st">'Country Name'</span>).T</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>filtered_data.index <span class="op">=</span> filtered_data.index.<span class="bu">str</span>.replace(<span class="st">'Year'</span>, <span class="st">''</span>)  <span class="co"># Simplify year labels</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country <span class="kw">in</span> filtered_data.columns:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    plt.plot(filtered_data.index, filtered_data[country], label<span class="op">=</span>country)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Adolescent Fertility Rate (Births per 1,000 Women Ages 15-19)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Fertility Rate'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Regions'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize ticks and grid</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>filtered_data.index[::<span class="dv">5</span>], rotation<span class="op">=</span><span class="dv">45</span>)  <span class="co"># Show every 5th year</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)  </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-ado-fer-line" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Adolescent Fertility Rate, 1974-2019">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ado-fer-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="project_report_files/figure-html/fig-ado-fer-line-output-1.png" alt="Adolescent Fertility Rate, 1974-2019" width="1139" height="565" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ado-fer-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Line Plot showing the adolescent fertility rate from 1974 to 2019
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ado-fer-line" class="quarto-xref">Figure&nbsp;1</a> illustrates trends in adolescent fertility rates (births per 1,000 women aged 15-19) across regions from 1974 to 2019: 1. Africa Eastern and Southern consistently shows the highest fertility rates, but there has been a steady decline over time. 2. North America has experienced fluctuations but maintains moderate levels of adolescent fertility compared to other regions. 3. East Asia &amp; Pacific and the European Union have the lowest adolescent fertility rates, showing significant declines and stabilizing at minimal levels over the years.</p>
<div id="cell-fig-sec-fer-scat" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to include all years</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>melted_data <span class="op">=</span> data.melt(id_vars<span class="op">=</span>[<span class="st">"Country Name"</span>, <span class="st">"Series Name"</span>], var_name<span class="op">=</span><span class="st">"Year"</span>, value_name<span class="op">=</span><span class="st">"Value"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter relevant data for fertility rate and secondary school enrollment</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>fertility_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"Adolescent fertility rate (births per 1,000 women ages 15-19)"</span>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>secondary_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"School enrollment, secondary (</span><span class="sc">% g</span><span class="st">ross)"</span>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge datasets and clean up</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>merged_data <span class="op">=</span> (</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    pd.merge(fertility_data, secondary_data, on<span class="op">=</span>[<span class="st">"Country Name"</span>, <span class="st">"Year"</span>], suffixes<span class="op">=</span>(<span class="st">"_Fertility"</span>, <span class="st">"_Secondary"</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Map regions and assign colors</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>region_colors <span class="op">=</span> {</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"North America"</span>: <span class="st">"blue"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Africa Eastern and Southern"</span>: <span class="st">"green"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"East Asia &amp; Pacific"</span>: <span class="st">"orange"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"European Union"</span>: <span class="st">"red"</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>merged_data[<span class="st">"Color"</span>] <span class="op">=</span> merged_data[<span class="st">"Country Name"</span>].<span class="bu">map</span>(region_colors)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the scatter plot</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, color <span class="kw">in</span> region_colors.items():</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> merged_data[merged_data[<span class="st">"Color"</span>] <span class="op">==</span> color]</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    plt.scatter(group[<span class="st">"Value_Secondary"</span>], group[<span class="st">"Value_Fertility"</span>], label<span class="op">=</span>region, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Relationship Between Secondary School Enrollment and Adolescent Fertility Rate"</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Secondary School Enrollment (</span><span class="sc">% g</span><span class="st">ross)"</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Adolescent Fertility Rate (births per 1,000 women ages 15-19)"</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Region"</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-sec-fer-scat" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Relationship Between Secondary School Enrollment and Adolescent Fertility Rate">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sec-fer-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="project_report_files/figure-html/fig-sec-fer-scat-output-1.png" alt="Relationship Between Secondary School Enrollment and Adolescent Fertility Rate" width="816" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sec-fer-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Scatterplot showing the relationship between secondary school enrollment and adolescent fertility rate
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-sec-fer-scat" class="quarto-xref">Figure&nbsp;2</a> shows an obvious negative correlation between secondary school enrollment and adolescent fertility rate.</p>
<div id="cell-fig-ter-fer-scat" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter relevant data for fertility rate and tertiary school enrollment</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tertiary_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"School enrollment, tertiary (</span><span class="sc">% g</span><span class="st">ross)"</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge datasets and clean up</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>merged_data <span class="op">=</span> (</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    pd.merge(fertility_data, tertiary_data, on<span class="op">=</span>[<span class="st">"Country Name"</span>, <span class="st">"Year"</span>], suffixes<span class="op">=</span>(<span class="st">"_Fertility"</span>, <span class="st">"_Tertiary"</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    .dropna(subset<span class="op">=</span>[<span class="st">"Value_Fertility"</span>, <span class="st">"Value_Tertiary"</span>])</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Map regions and assign colors</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>region_colors <span class="op">=</span> {</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"North America"</span>: <span class="st">"blue"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Africa Eastern and Southern"</span>: <span class="st">"green"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"East Asia &amp; Pacific"</span>: <span class="st">"orange"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"European Union"</span>: <span class="st">"red"</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>merged_data[<span class="st">"Color"</span>] <span class="op">=</span> merged_data[<span class="st">"Country Name"</span>].<span class="bu">map</span>(region_colors)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the scatter plot</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, color <span class="kw">in</span> region_colors.items():</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> merged_data[merged_data[<span class="st">"Color"</span>] <span class="op">==</span> color]</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    plt.scatter(group[<span class="st">"Value_Tertiary"</span>], group[<span class="st">"Value_Fertility"</span>], label<span class="op">=</span>region, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Relationship Between Tertiary School Enrollment and Adolescent Fertility Rate"</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tertiary School Enrollment (</span><span class="sc">% g</span><span class="st">ross)"</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Adolescent Fertility Rate (births per 1,000 women ages 15-19)"</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Region"</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-ter-fer-scat" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Relationship Between Tertiary School Enrollment and Adolescent Fertility Rate">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ter-fer-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="project_report_files/figure-html/fig-ter-fer-scat-output-1.png" alt="Relationship Between Tertiary School Enrollment and Adolescent Fertility Rate" width="816" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ter-fer-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Scatterplot showing the Relationship Between Tertiary School Enrollment and Adolescent Fertility Rate
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ter-fer-scat" class="quarto-xref">Figure&nbsp;3</a> shows the relationship between tertiary school enrollment and adolescent fertility rate. The graph shows an obvious negative correlation between tertiary school enrollment and adolescent fertility rate; and compared to the previous graph of secondary education, the slope is steeper.</p>
<div id="cell-fig-gdp-fer-scat" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter relevant data for adolescent fertility and GDP per capita</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"GDP per capita (current US$)"</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge datasets and clean up</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>merged_data <span class="op">=</span> (</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    pd.merge(fertility_data, gdp_data, on<span class="op">=</span>[<span class="st">"Country Name"</span>, <span class="st">"Year"</span>], suffixes<span class="op">=</span>(<span class="st">"_Fertility"</span>, <span class="st">"_GDP"</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    .dropna(subset<span class="op">=</span>[<span class="st">"Value_Fertility"</span>, <span class="st">"Value_GDP"</span>])</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Map regions and assign colors</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>region_colors <span class="op">=</span> {</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"North America"</span>: <span class="st">"blue"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Africa Eastern and Southern"</span>: <span class="st">"green"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"East Asia &amp; Pacific"</span>: <span class="st">"orange"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"European Union"</span>: <span class="st">"red"</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>merged_data[<span class="st">"Color"</span>] <span class="op">=</span> merged_data[<span class="st">"Country Name"</span>].<span class="bu">map</span>(region_colors)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the scatter plot</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, color <span class="kw">in</span> region_colors.items():</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> merged_data[merged_data[<span class="st">"Color"</span>] <span class="op">==</span> color]</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    plt.scatter(group[<span class="st">"Value_GDP"</span>], group[<span class="st">"Value_Fertility"</span>], label<span class="op">=</span>region, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Relationship Between GDP per Capita and Adolescent Fertility Rate"</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"GDP per Capita (US$)"</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Adolescent Fertility Rate (births per 1,000 women ages 15-19)"</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Region"</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gdp-fer-scat" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Relationship Between GDP per Capita and Adolescent Fertility Rate">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gdp-fer-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="project_report_files/figure-html/fig-gdp-fer-scat-output-1.png" alt="Relationship Between GDP per Capita and Adolescent Fertility Rate" width="816" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gdp-fer-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Scatterplot showing the Relationship Between GDP per Capita and Adolescent Fertility Rate
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gdp-fer-scat" class="quarto-xref">Figure&nbsp;4</a> shows an obvious negative correlation between GDP per capita and adolescent fertility rate; and compared to the previous graphs, the slope is the steepest.</p>
<div id="cell-fig-sec-gdp-scat" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter relevant data for GDP per capita, secondary, and tertiary school enrollment</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"GDP per capita (current US$)"</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>secondary_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"School enrollment, secondary (</span><span class="sc">% g</span><span class="st">ross)"</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>tertiary_data <span class="op">=</span> melted_data[melted_data[<span class="st">"Series Name"</span>] <span class="op">==</span> <span class="st">"School enrollment, tertiary (</span><span class="sc">% g</span><span class="st">ross)"</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge GDP with secondary school enrollment</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>merged_secondary <span class="op">=</span> pd.merge(gdp_data, secondary_data, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                            on<span class="op">=</span>[<span class="st">"Country Name"</span>, <span class="st">"Year"</span>], </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                            suffixes<span class="op">=</span>(<span class="st">"_GDP"</span>, <span class="st">"_Secondary"</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge GDP with tertiary school enrollment</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>merged_tertiary <span class="op">=</span> pd.merge(gdp_data, tertiary_data, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                           on<span class="op">=</span>[<span class="st">"Country Name"</span>, <span class="st">"Year"</span>], </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                           suffixes<span class="op">=</span>(<span class="st">"_GDP"</span>, <span class="st">"_Tertiary"</span>))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define regions and assign colors (example mapping, adjust as necessary)</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>region_colors <span class="op">=</span> {</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"North America"</span>: <span class="st">"blue"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Africa Eastern and Southern"</span>: <span class="st">"green"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"East Asia &amp; Pacific"</span>: <span class="st">"orange"</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"European Union"</span>: <span class="st">"red"</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Map colors to regions</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>merged_secondary[<span class="st">"Color"</span>] <span class="op">=</span> merged_secondary[<span class="st">"Country Name"</span>].<span class="bu">map</span>(region_colors)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>merged_tertiary[<span class="st">"Color"</span>] <span class="op">=</span> merged_tertiary[<span class="st">"Country Name"</span>].<span class="bu">map</span>(region_colors)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for secondary school enrollment</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, color <span class="kw">in</span> region_colors.items():</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> merged_secondary[merged_secondary[<span class="st">"Color"</span>] <span class="op">==</span> color]</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    plt.scatter(group[<span class="st">"Value_Secondary"</span>], group[<span class="st">"Value_GDP"</span>], label<span class="op">=</span>region, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Relationship Between Secondary School Enrollment and GDP per Capita"</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Secondary School Enrollment (</span><span class="sc">% g</span><span class="st">ross)"</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"GDP per Capita (current US$)"</span>)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Region"</span>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-sec-gdp-scat" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Relationship Between Secondary School Enrollment and GDP per Capita">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sec-gdp-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="project_report_files/figure-html/fig-sec-gdp-scat-output-1.png" alt="Relationship Between Secondary School Enrollment and GDP per Capita" width="833" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sec-gdp-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Scatterplot showing the Relationship Between Secondary School Enrollment and GDP per Capita
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-sec-gdp-scat" class="quarto-xref">Figure&nbsp;5</a> demonstrates a positive relationship between secondary school enrollment (% gross) and GDP per capita across regions. Countries with higher secondary school enrollment tend to have higher GDP per capita, with distinct clustering patterns by region. North America and the European Union show the highest GDP per capita with high enrollment rates, while Africa exhibits lower GDP levels despite varying enrollment percentages.</p>
<div id="cell-fig-ter-gdp-scat" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for tertiary school enrollment</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region, color <span class="kw">in</span> region_colors.items():</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> merged_tertiary[merged_tertiary[<span class="st">"Color"</span>] <span class="op">==</span> color]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    plt.scatter(group[<span class="st">"Value_Tertiary"</span>], group[<span class="st">"Value_GDP"</span>], label<span class="op">=</span>region, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Relationship Between Tertiary School Enrollment and GDP per Capita"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tertiary School Enrollment (</span><span class="sc">% g</span><span class="st">ross)"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"GDP per Capita (current US$)"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Region"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-ter-gdp-scat" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Relationship Between Tertiary School Enrollment and GDP per Capita">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ter-gdp-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="project_report_files/figure-html/fig-ter-gdp-scat-output-1.png" alt="Relationship Between Tertiary School Enrollment and GDP per Capita" width="833" height="523" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ter-gdp-scat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Scatterplot showing the Relationship Between Tertiary School Enrollment and GDP per Capita
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ter-gdp-scat" class="quarto-xref">Figure&nbsp;6</a> highlights a positive correlation between tertiary school enrollment (% gross) and GDP per capita. Regions such as North America and the European Union exhibit high GDP per capita alongside higher tertiary enrollment rates, indicating the potential influence of advanced education on economic prosperity. Conversely, regions like Africa show lower GDP per capita and tertiary enrollment, suggesting gaps in higher education access and economic outcomes.</p>
</section>
</section>
<section id="regression-analysis" class="level1">
<h1>Regression Analysis</h1>
<section id="rename-and-reshape-dataset" class="level2">
<h2 class="anchored" data-anchor-id="rename-and-reshape-dataset">Rename and Reshape dataset</h2>
<div id="9dd6ae1b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import necessary packages and dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> stargazer.stargazer <span class="im">import</span> Stargazer</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.core.display <span class="im">import</span> HTML</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1b3f7587" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use relative paths to increase reproducibility</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"/Users/yangziyu/Desktop/QTM 350/final_project/qtm350-final-project/data/WBData_Further_Cleaned.csv"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c2db0ca3" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename "Country Name" to "Region"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data.rename(columns<span class="op">=</span>{<span class="st">"Country Name"</span>: <span class="st">"Region"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the dataset to a long format</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>data_long <span class="op">=</span> data.melt(id_vars<span class="op">=</span>[<span class="st">"Region"</span>, <span class="st">"Series Name"</span>], </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                      var_name<span class="op">=</span><span class="st">"Year"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                      value_name<span class="op">=</span><span class="st">"Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="51c324e3" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the dataset</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data_long.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">Series Name</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>North America</td>
<td>Adolescent fertility rate (births per 1,000 wo...</td>
<td>Year1974</td>
<td>54.047027</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>North America</td>
<td>Fertility rate, total (births per woman)</td>
<td>Year1974</td>
<td>1.835234</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>North America</td>
<td>School enrollment, tertiary (% gross)</td>
<td>Year1974</td>
<td>48.543449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>North America</td>
<td>School enrollment, secondary (% gross)</td>
<td>Year1974</td>
<td>87.572639</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>North America</td>
<td>School enrollment, primary (% gross)</td>
<td>Year1974</td>
<td>95.018700</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1a502a88" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the Year column</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_long[<span class="st">'Year'</span>] <span class="op">=</span> data_long[<span class="st">'Year'</span>].<span class="bu">str</span>.extract(<span class="st">'(\d+)'</span>).astype(<span class="bu">int</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to create a clean dataset for analysis</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="op">=</span> data_long.pivot_table(index<span class="op">=</span>[<span class="st">"Region"</span>, <span class="st">"Year"</span>], </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                                      columns<span class="op">=</span><span class="st">"Series Name"</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                                      values<span class="op">=</span><span class="st">"Value"</span>).reset_index()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>analysis_data.rename(columns<span class="op">=</span>{</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adolescent fertility rate (births per 1,000 women ages 15-19)"</span>: <span class="st">"adolescent_fertility"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GDP per capita (current US$)"</span>: <span class="st">"gdp_per_capita"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School enrollment, primary (</span><span class="sc">% g</span><span class="st">ross)"</span>: <span class="st">"school_enrollment_primary"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School enrollment, secondary (</span><span class="sc">% g</span><span class="st">ross)"</span>: <span class="st">"school_enrollment_secondary"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"School enrollment, tertiary (</span><span class="sc">% g</span><span class="st">ross)"</span>: <span class="st">"school_enrollment_tertiary"</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h2>
<p>In this part, we generate the correlation matrices for all variables in four regions.</p>
<div id="2f853802" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the unique regions</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>regions <span class="op">=</span> analysis_data[<span class="st">'Region'</span>].unique()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each region and calculate the correlation matrix</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> region <span class="kw">in</span> regions:</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    region_data <span class="op">=</span> analysis_data[analysis_data[<span class="st">'Region'</span>] <span class="op">==</span> region]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    numeric_data <span class="op">=</span> region_data.select_dtypes(include<span class="op">=</span>[<span class="bu">float</span>, <span class="bu">int</span>])</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    correlation_matrix <span class="op">=</span> numeric_data.corr()</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the heatmap</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, fmt<span class="op">=</span><span class="st">".2f"</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Correlation Matrix for </span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f"</span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">_correlation_matrix.png"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    plt.show()  <span class="co"># Close the plot to avoid overlapping</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="project_report_files/figure-html/cell-18-output-1.png" width="1146" height="1059" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="project_report_files/figure-html/cell-18-output-2.png" width="1146" height="1059" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="project_report_files/figure-html/cell-18-output-3.png" width="1146" height="1059" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="project_report_files/figure-html/cell-18-output-4.png" width="1146" height="1059" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Findings:</p>
<ol type="1">
<li><p>The Role of Education: In all regions, higher secondary and tertiary school enrollments are strongly negatively correlated with adolescent fertility, which highlights the importance of advanced education in reducing teenage fertility rates.</p></li>
<li><p>Economic Influence: GDP per capita consistently shows a strong negative correlation with adolescent fertility rates, with wealthier regions tending to have lower adolescent fertility.</p></li>
<li><p>Regional Differences: Africa shows the strongest link between education and reduced fertility, while North America and East Asia show weaker correlations, indicating other factors may be at play.</p></li>
</ol>
</section>
<section id="regression-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="regression-analysis-1">Regression Analysis</h2>
<section id="ols-regression-before-standardizing-variables" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-before-standardizing-variables">OLS Regression before standardizing variables</h3>
<p>We only include school_enrollment_secondary and tertiary since there is perfect multicollinearity within the school_enrollment category.</p>
<div id="e07f0329" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'adolescent_fertility ~ gdp_per_capita+ school_enrollment_secondary+school_enrollment_tertiary'</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             data<span class="op">=</span>analysis_data).fit()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add dummies region and year</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'adolescent_fertility ~ gdp_per_capita + school_enrollment_secondary+school_enrollment_tertiary+C(Region)+C(Year)'</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             data<span class="op">=</span>analysis_data).fit()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>m2.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>adolescent_fertility</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.995</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.993</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>502.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Mon, 09 Dec 2024</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>1.76e-141</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>18:08:17</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-512.12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>200</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>1136.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>144</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>1321.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>55</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>147.1038</td>
<td>2.190</td>
<td>67.184</td>
<td>0.000</td>
<td>142.776</td>
<td>151.432</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Region)[T.East Asia &amp; Pacific]</td>
<td>-108.1089</td>
<td>1.984</td>
<td>-54.502</td>
<td>0.000</td>
<td>-112.030</td>
<td>-104.188</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Region)[T.European Union]</td>
<td>-133.3580</td>
<td>4.085</td>
<td>-32.647</td>
<td>0.000</td>
<td>-141.432</td>
<td>-125.284</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Region)[T.North America]</td>
<td>-125.4724</td>
<td>4.295</td>
<td>-29.214</td>
<td>0.000</td>
<td>-133.962</td>
<td>-116.983</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1975]</td>
<td>-1.8602</td>
<td>2.610</td>
<td>-0.713</td>
<td>0.477</td>
<td>-7.020</td>
<td>3.299</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1976]</td>
<td>-3.7630</td>
<td>2.611</td>
<td>-1.441</td>
<td>0.152</td>
<td>-8.924</td>
<td>1.398</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1977]</td>
<td>-4.9278</td>
<td>2.612</td>
<td>-1.886</td>
<td>0.061</td>
<td>-10.091</td>
<td>0.236</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1978]</td>
<td>-7.1518</td>
<td>2.613</td>
<td>-2.737</td>
<td>0.007</td>
<td>-12.317</td>
<td>-1.987</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1979]</td>
<td>-8.2173</td>
<td>2.612</td>
<td>-3.146</td>
<td>0.002</td>
<td>-13.380</td>
<td>-3.054</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1980]</td>
<td>-9.2459</td>
<td>2.617</td>
<td>-3.533</td>
<td>0.001</td>
<td>-14.418</td>
<td>-4.074</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1981]</td>
<td>-10.0428</td>
<td>2.616</td>
<td>-3.839</td>
<td>0.000</td>
<td>-15.213</td>
<td>-4.873</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1982]</td>
<td>-9.6984</td>
<td>2.617</td>
<td>-3.705</td>
<td>0.000</td>
<td>-14.872</td>
<td>-4.525</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1983]</td>
<td>-10.6243</td>
<td>2.618</td>
<td>-4.059</td>
<td>0.000</td>
<td>-15.798</td>
<td>-5.450</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1984]</td>
<td>-11.4365</td>
<td>2.620</td>
<td>-4.365</td>
<td>0.000</td>
<td>-16.616</td>
<td>-6.257</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1985]</td>
<td>-12.2202</td>
<td>2.623</td>
<td>-4.660</td>
<td>0.000</td>
<td>-17.404</td>
<td>-7.037</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1986]</td>
<td>-13.4189</td>
<td>2.631</td>
<td>-5.101</td>
<td>0.000</td>
<td>-18.619</td>
<td>-8.219</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1987]</td>
<td>-13.9575</td>
<td>2.641</td>
<td>-5.285</td>
<td>0.000</td>
<td>-19.178</td>
<td>-8.737</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1988]</td>
<td>-14.4751</td>
<td>2.649</td>
<td>-5.464</td>
<td>0.000</td>
<td>-19.711</td>
<td>-9.239</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1989]</td>
<td>-14.5984</td>
<td>2.654</td>
<td>-5.501</td>
<td>0.000</td>
<td>-19.843</td>
<td>-9.353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1990]</td>
<td>-13.7811</td>
<td>2.663</td>
<td>-5.176</td>
<td>0.000</td>
<td>-19.044</td>
<td>-8.518</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1991]</td>
<td>-14.9258</td>
<td>2.669</td>
<td>-5.592</td>
<td>0.000</td>
<td>-20.201</td>
<td>-9.650</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1992]</td>
<td>-18.0794</td>
<td>2.682</td>
<td>-6.742</td>
<td>0.000</td>
<td>-23.380</td>
<td>-12.779</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1993]</td>
<td>-19.4731</td>
<td>2.696</td>
<td>-7.222</td>
<td>0.000</td>
<td>-24.802</td>
<td>-14.144</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1994]</td>
<td>-22.0077</td>
<td>2.715</td>
<td>-8.107</td>
<td>0.000</td>
<td>-27.373</td>
<td>-16.642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1995]</td>
<td>-23.9605</td>
<td>2.730</td>
<td>-8.776</td>
<td>0.000</td>
<td>-29.357</td>
<td>-18.564</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1996]</td>
<td>-25.0960</td>
<td>2.745</td>
<td>-9.142</td>
<td>0.000</td>
<td>-30.522</td>
<td>-19.670</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1997]</td>
<td>-26.6556</td>
<td>2.752</td>
<td>-9.687</td>
<td>0.000</td>
<td>-32.094</td>
<td>-21.217</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.1998]</td>
<td>-26.9160</td>
<td>2.757</td>
<td>-9.764</td>
<td>0.000</td>
<td>-32.365</td>
<td>-21.467</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.1999]</td>
<td>-27.5346</td>
<td>2.768</td>
<td>-9.948</td>
<td>0.000</td>
<td>-33.005</td>
<td>-22.064</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2000]</td>
<td>-28.2337</td>
<td>2.773</td>
<td>-10.180</td>
<td>0.000</td>
<td>-33.716</td>
<td>-22.752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2001]</td>
<td>-30.1111</td>
<td>2.792</td>
<td>-10.786</td>
<td>0.000</td>
<td>-35.629</td>
<td>-24.593</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2002]</td>
<td>-32.6140</td>
<td>2.810</td>
<td>-11.606</td>
<td>0.000</td>
<td>-38.168</td>
<td>-27.060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2003]</td>
<td>-34.5024</td>
<td>2.844</td>
<td>-12.133</td>
<td>0.000</td>
<td>-40.123</td>
<td>-28.882</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2004]</td>
<td>-35.7343</td>
<td>2.876</td>
<td>-12.424</td>
<td>0.000</td>
<td>-41.419</td>
<td>-30.049</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2005]</td>
<td>-36.5688</td>
<td>2.912</td>
<td>-12.557</td>
<td>0.000</td>
<td>-42.325</td>
<td>-30.812</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2006]</td>
<td>-37.3614</td>
<td>2.956</td>
<td>-12.640</td>
<td>0.000</td>
<td>-43.204</td>
<td>-31.519</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2007]</td>
<td>-37.6682</td>
<td>3.016</td>
<td>-12.490</td>
<td>0.000</td>
<td>-43.629</td>
<td>-31.707</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2008]</td>
<td>-37.9738</td>
<td>3.072</td>
<td>-12.361</td>
<td>0.000</td>
<td>-44.046</td>
<td>-31.902</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2009]</td>
<td>-39.9337</td>
<td>3.083</td>
<td>-12.951</td>
<td>0.000</td>
<td>-46.028</td>
<td>-33.839</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2010]</td>
<td>-41.5612</td>
<td>3.125</td>
<td>-13.300</td>
<td>0.000</td>
<td>-47.738</td>
<td>-35.385</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2011]</td>
<td>-42.9045</td>
<td>3.173</td>
<td>-13.521</td>
<td>0.000</td>
<td>-49.177</td>
<td>-36.633</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2012]</td>
<td>-44.3375</td>
<td>3.181</td>
<td>-13.940</td>
<td>0.000</td>
<td>-50.624</td>
<td>-38.051</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2013]</td>
<td>-46.0675</td>
<td>3.223</td>
<td>-14.294</td>
<td>0.000</td>
<td>-52.438</td>
<td>-39.697</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2014]</td>
<td>-48.0340</td>
<td>3.239</td>
<td>-14.830</td>
<td>0.000</td>
<td>-54.436</td>
<td>-41.632</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2015]</td>
<td>-50.1660</td>
<td>3.221</td>
<td>-15.575</td>
<td>0.000</td>
<td>-56.532</td>
<td>-43.800</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2016]</td>
<td>-51.7542</td>
<td>3.227</td>
<td>-16.036</td>
<td>0.000</td>
<td>-58.133</td>
<td>-45.375</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2017]</td>
<td>-53.0040</td>
<td>3.258</td>
<td>-16.268</td>
<td>0.000</td>
<td>-59.444</td>
<td>-46.564</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2018]</td>
<td>-54.1821</td>
<td>3.298</td>
<td>-16.426</td>
<td>0.000</td>
<td>-60.702</td>
<td>-47.662</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2019]</td>
<td>-54.9807</td>
<td>3.321</td>
<td>-16.553</td>
<td>0.000</td>
<td>-61.546</td>
<td>-48.416</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2020]</td>
<td>-56.4061</td>
<td>3.325</td>
<td>-16.966</td>
<td>0.000</td>
<td>-62.977</td>
<td>-49.835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2021]</td>
<td>-57.0683</td>
<td>3.408</td>
<td>-16.747</td>
<td>0.000</td>
<td>-63.804</td>
<td>-50.333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C(Year)[T.2022]</td>
<td>-57.5480</td>
<td>3.410</td>
<td>-16.876</td>
<td>0.000</td>
<td>-64.288</td>
<td>-50.808</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">C(Year)[T.2023]</td>
<td>-57.7344</td>
<td>3.457</td>
<td>-16.699</td>
<td>0.000</td>
<td>-64.568</td>
<td>-50.900</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gdp_per_capita</td>
<td>-0.0001</td>
<td>5.04e-05</td>
<td>-2.067</td>
<td>0.041</td>
<td>-0.000</td>
<td>-4.54e-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">school_enrollment_secondary</td>
<td>0.0788</td>
<td>0.058</td>
<td>1.347</td>
<td>0.180</td>
<td>-0.037</td>
<td>0.194</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">school_enrollment_tertiary</td>
<td>0.5862</td>
<td>0.042</td>
<td>13.949</td>
<td>0.000</td>
<td>0.503</td>
<td>0.669</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>4.037</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>0.172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.133</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>2.651</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>-0.079</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.266</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>2.458</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>1.41e+06</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 1.41e+06. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<div id="ae177d89" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> Stargazer([m1,m2])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>HTML(ms.render_html())</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ms.title(<span class="st">'Regression on Fertility'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>ms.custom_columns([<span class="st">'All'</span>,<span class="st">'With Dummies'</span>], [<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>HTML(ms.render_html())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
Regression on Fertility<br><table style="text-align:center"><tbody><tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td colspan="2"><em>Dependent variable: adolescent_fertility</em></td></tr><tr><td style="text-align:left"></td></tr><tr><td></td><td colspan="1">All</td><td colspan="1">With Dummies</td></tr><tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td></tr>
<tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr>

<tr><td style="text-align:left">C(Region)[T.East Asia &amp; Pacific]</td><td></td><td>-108.109<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(1.984)</td></tr>
<tr><td style="text-align:left">C(Region)[T.European Union]</td><td></td><td>-133.358<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(4.085)</td></tr>
<tr><td style="text-align:left">C(Region)[T.North America]</td><td></td><td>-125.472<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(4.295)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1975]</td><td></td><td>-1.860<sup></sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.610)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1976]</td><td></td><td>-3.763<sup></sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.611)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1977]</td><td></td><td>-4.928<sup>*</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.612)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1978]</td><td></td><td>-7.152<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.613)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1979]</td><td></td><td>-8.217<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.612)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1980]</td><td></td><td>-9.246<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.617)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1981]</td><td></td><td>-10.043<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.616)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1982]</td><td></td><td>-9.698<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.617)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1983]</td><td></td><td>-10.624<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.618)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1984]</td><td></td><td>-11.437<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.620)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1985]</td><td></td><td>-12.220<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.623)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1986]</td><td></td><td>-13.419<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.631)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1987]</td><td></td><td>-13.957<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.641)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1988]</td><td></td><td>-14.475<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.649)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1989]</td><td></td><td>-14.598<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.654)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1990]</td><td></td><td>-13.781<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.663)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1991]</td><td></td><td>-14.926<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.669)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1992]</td><td></td><td>-18.079<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.682)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1993]</td><td></td><td>-19.473<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.696)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1994]</td><td></td><td>-22.008<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.715)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1995]</td><td></td><td>-23.961<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.730)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1996]</td><td></td><td>-25.096<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.745)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1997]</td><td></td><td>-26.656<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.752)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1998]</td><td></td><td>-26.916<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.757)</td></tr>
<tr><td style="text-align:left">C(Year)[T.1999]</td><td></td><td>-27.535<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.768)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2000]</td><td></td><td>-28.234<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.773)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2001]</td><td></td><td>-30.111<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.792)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2002]</td><td></td><td>-32.614<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.810)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2003]</td><td></td><td>-34.502<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.844)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2004]</td><td></td><td>-35.734<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.876)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2005]</td><td></td><td>-36.569<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.912)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2006]</td><td></td><td>-37.361<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.956)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2007]</td><td></td><td>-37.668<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.016)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2008]</td><td></td><td>-37.974<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.072)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2009]</td><td></td><td>-39.934<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.083)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2010]</td><td></td><td>-41.561<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.125)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2011]</td><td></td><td>-42.905<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.173)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2012]</td><td></td><td>-44.337<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.181)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2013]</td><td></td><td>-46.067<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.223)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2014]</td><td></td><td>-48.034<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.239)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2015]</td><td></td><td>-50.166<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.221)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2016]</td><td></td><td>-51.754<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.227)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2017]</td><td></td><td>-53.004<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.258)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2018]</td><td></td><td>-54.182<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.298)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2019]</td><td></td><td>-54.981<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.321)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2020]</td><td></td><td>-56.406<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.325)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2021]</td><td></td><td>-57.068<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.408)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2022]</td><td></td><td>-57.548<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.410)</td></tr>
<tr><td style="text-align:left">C(Year)[T.2023]</td><td></td><td>-57.734<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(3.457)</td></tr>
<tr><td style="text-align:left">Intercept</td><td>162.126<sup>***</sup></td><td>147.104<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(4.755)</td><td>(2.190)</td></tr>
<tr><td style="text-align:left">gdp_per_capita</td><td>-0.001<sup>***</sup></td><td>-0.000<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.000)</td><td>(0.000)</td></tr>
<tr><td style="text-align:left">school_enrollment_secondary</td><td>-2.024<sup>***</sup></td><td>0.079<sup></sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.107)</td><td>(0.058)</td></tr>
<tr><td style="text-align:left">school_enrollment_tertiary</td><td>1.362<sup>***</sup></td><td>0.586<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.169)</td><td>(0.042)</td></tr>

<tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align: left">Observations</td><td>200</td><td>200</td></tr><tr><td style="text-align: left">R<sup>2</sup></td><td>0.771</td><td>0.995</td></tr><tr><td style="text-align: left">Adjusted R<sup>2</sup></td><td>0.768</td><td>0.993</td></tr><tr><td style="text-align: left">Residual Std. Error</td><td>21.017 (df=196)</td><td>3.691 (df=144)</td></tr><tr><td style="text-align: left">F Statistic</td><td>220.400<sup>***</sup> (df=3; 196)</td><td>502.698<sup>***</sup> (df=55; 144)</td></tr>
<tr><td colspan="3" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align: left">Note:</td><td colspan="2" style="text-align: right"><sup>*</sup>p&lt;0.1; <sup>**</sup>p&lt;0.05; <sup>***</sup>p&lt;0.01</td></tr></tbody></table>
</div>
</div>
<p>Through runing the OLS regression, we find that due to the inconsistent scale of different variables, it is difficult to make comparison between regressors. Also, there is strong multicollinearity in our model. To address these problems, we standardize variables and use Ridge regression to compare with OLS regression. There might be too many dummy variables as well. So we create a different variable called year_grouped that classify them into decades.</p>
</section>
<section id="standardizing-and-refining-dataset" class="level3">
<h3 class="anchored" data-anchor-id="standardizing-and-refining-dataset">Standardizing and refining dataset</h3>
<div id="38816f3c" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Group years into decades</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>analysis_data[<span class="st">"Year_grouped"</span>] <span class="op">=</span> (analysis_data[<span class="st">"Year"</span>] <span class="op">//</span> <span class="dv">10</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy of the dataset</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="op">=</span> analysis_data.copy()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the scaler</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Select numeric columns to scale, excluding 'Year' and 'Year_grouped'</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>numeric_columns_to_scale <span class="op">=</span> [</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    col <span class="cf">for</span> col <span class="kw">in</span> scaled_data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'Year'</span>, <span class="st">'Year_grouped'</span>]</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the selected numeric columns</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>scaled_data[numeric_columns_to_scale] <span class="op">=</span> scaler.fit_transform(scaled_data[numeric_columns_to_scale])</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Year' and 'Year_grouped' remain unscaled</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>scaled_data[<span class="st">'Year'</span>] <span class="op">=</span> analysis_data[<span class="st">'Year'</span>]</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>scaled_data[<span class="st">'Year_grouped'</span>] <span class="op">=</span> analysis_data[<span class="st">'Year_grouped'</span>]</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>scaled_data[<span class="st">'Region'</span>] <span class="op">=</span> analysis_data[<span class="st">'Region'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5646a53f" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Add dummy variables for 'Region' and the new 'Year_grouped' column</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(scaled_data, columns<span class="op">=</span>[<span class="st">"Region"</span>, <span class="st">"Year_grouped"</span>], drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Replace boolean values (False -&gt; 0, True -&gt; 1) in the entire dataset</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.replace({<span class="va">False</span>: <span class="dv">0</span>, <span class="va">True</span>: <span class="dv">1</span>})</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Confirm the changes</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/ht/cp5bzsp52ll5g4wdvrjntjmh0000gn/T/ipykernel_18825/1281065974.py:5: FutureWarning:

Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">adolescent_fertility</th>
<th data-quarto-table-cell-role="th">Fertility rate, total (births per woman)</th>
<th data-quarto-table-cell-role="th">gdp_per_capita</th>
<th data-quarto-table-cell-role="th">school_enrollment_primary</th>
<th data-quarto-table-cell-role="th">school_enrollment_secondary</th>
<th data-quarto-table-cell-role="th">school_enrollment_tertiary</th>
<th data-quarto-table-cell-role="th">Region_East Asia &amp; Pacific</th>
<th data-quarto-table-cell-role="th">Region_European Union</th>
<th data-quarto-table-cell-role="th">Region_North America</th>
<th data-quarto-table-cell-role="th">Year_grouped_1980</th>
<th data-quarto-table-cell-role="th">Year_grouped_1990</th>
<th data-quarto-table-cell-role="th">Year_grouped_2000</th>
<th data-quarto-table-cell-role="th">Year_grouped_2010</th>
<th data-quarto-table-cell-role="th">Year_grouped_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1974</td>
<td>2.302721</td>
<td>2.313122</td>
<td>-0.853996</td>
<td>-3.083716</td>
<td>-1.829018</td>
<td>-1.165587</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1975</td>
<td>2.288087</td>
<td>2.304245</td>
<td>-0.853207</td>
<td>-2.873967</td>
<td>-1.811159</td>
<td>-1.164089</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1976</td>
<td>2.257421</td>
<td>2.293087</td>
<td>-0.853529</td>
<td>-2.740359</td>
<td>-1.795747</td>
<td>-1.163066</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1977</td>
<td>2.220591</td>
<td>2.282584</td>
<td>-0.851384</td>
<td>-2.575036</td>
<td>-1.781237</td>
<td>-1.162165</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1978</td>
<td>2.168030</td>
<td>2.272379</td>
<td>-0.849062</td>
<td>-2.477582</td>
<td>-1.761371</td>
<td>-1.159559</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="comparison-between-ridge-and-ols-regression-after-revising-dataset" class="level3">
<h3 class="anchored" data-anchor-id="comparison-between-ridge-and-ols-regression-after-revising-dataset">Comparison between Ridge and OLS Regression after revising dataset</h3>
<div id="d001dd11" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> RidgeCV, Ridge</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score, mean_squared_error</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define predictors (X) and dependent variable (y)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"adolescent_fertility"</span>,<span class="st">'Fertility rate, total (births per woman)'</span>,<span class="st">'Year'</span>,<span class="st">'school_enrollment_tertiary'</span>])  <span class="co"># Explanatory variables</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'adolescent_fertility'</span>]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine-tune Ridge regression with cross-validation to select the best alpha</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="fl">10.0</span>, <span class="fl">100.0</span>]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>ridge_cv <span class="op">=</span> RidgeCV(alphas<span class="op">=</span>alphas, cv<span class="op">=</span><span class="dv">5</span>).fit(X, y)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Best alpha selected by cross-validation</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>best_alpha <span class="op">=</span> ridge_cv.alpha_</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Ridge regression with the best alpha</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>ridge_model <span class="op">=</span> Ridge(alpha<span class="op">=</span>best_alpha).fit(X, y)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from Ridge regression</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>ridge_coefficients <span class="op">=</span> pd.DataFrame({</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Variable'</span>: X.columns,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coefficient'</span>: ridge_model.coef_</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions and performance for Ridge regression</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>y_pred_ridge <span class="op">=</span> ridge_model.predict(X)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>ridge_r2 <span class="op">=</span> r2_score(y, y_pred_ridge)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>ridge_mse <span class="op">=</span> mean_squared_error(y, y_pred_ridge)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit OLS regression for comparison</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>ols_model <span class="op">=</span> sm.OLS(y, sm.add_constant(X)).fit()</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>ols_r2 <span class="op">=</span> ols_model.rsquared</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>ols_mse <span class="op">=</span> mean_squared_error(y, ols_model.predict(sm.add_constant(X)))</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from OLS regression</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>ols_coefficients <span class="op">=</span> pd.DataFrame({</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Variable'</span>: [<span class="st">'const'</span>] <span class="op">+</span> <span class="bu">list</span>(X.columns),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coefficient'</span>: ols_model.params</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Results</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Ridge Regression Coefficients:"</span>)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ridge_coefficients)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Ridge Regression: R^2 = </span><span class="sc">{</span>ridge_r2<span class="sc">:.3f}</span><span class="ss">, MSE = </span><span class="sc">{</span>ridge_mse<span class="sc">:.3f}</span><span class="ss">, Best Alpha = </span><span class="sc">{</span>best_alpha<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">OLS Regression Coefficients:"</span>)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ols_coefficients)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">OLS Regression: R^2 = </span><span class="sc">{</span>ols_r2<span class="sc">:.3f}</span><span class="ss">, MSE = </span><span class="sc">{</span>ols_mse<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ridge Regression Coefficients:
                       Variable  Coefficient
0                gdp_per_capita    -0.217385
1     school_enrollment_primary    -0.322671
2   school_enrollment_secondary    -0.516964
3    Region_East Asia &amp; Pacific    -0.648517
4         Region_European Union    -0.294195
5          Region_North America     0.171980
6             Year_grouped_1980     0.000768
7             Year_grouped_1990    -0.009741
8             Year_grouped_2000     0.076593
9             Year_grouped_2010     0.137006
10            Year_grouped_2020     0.067865

Ridge Regression: R^2 = 0.958, MSE = 0.042, Best Alpha = 10.0

OLS Regression Coefficients:
                                                Variable  Coefficient
const                                              const     1.712919
gdp_per_capita                            gdp_per_capita    -0.078603
school_enrollment_primary      school_enrollment_primary    -0.125334
school_enrollment_secondary  school_enrollment_secondary     0.031347
Region_East Asia &amp; Pacific    Region_East Asia &amp; Pacific    -1.981365
Region_European Union              Region_European Union    -2.212790
Region_North America                Region_North America    -1.677342
Year_grouped_1980                      Year_grouped_1980    -0.053124
Year_grouped_1990                      Year_grouped_1990    -0.181312
Year_grouped_2000                      Year_grouped_2000    -0.308774
Year_grouped_2010                      Year_grouped_2010    -0.453222
Year_grouped_2020                      Year_grouped_2020    -0.571979

OLS Regression: R^2 = 0.987, MSE = 0.013</code></pre>
</div>
</div>
<p>As shown in the table, ridge is better since it address multicollinearity and remain in a high r squared.</p>
</section>
<section id="run-ridge-model-to-check-rubustness" class="level3">
<h3 class="anchored" data-anchor-id="run-ridge-model-to-check-rubustness">Run Ridge Model to Check Rubustness</h3>
<div id="1f388754" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> RidgeCV, Ridge</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score, mean_squared_error</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to run Ridge regression with specified variable inclusions</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_ridge_with_inclusion(X, y, variables_to_include):</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Include only specified variables</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    X_subset <span class="op">=</span> X[variables_to_include]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fine-tune Ridge regression with cross-validation to select the best alpha</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    alphas <span class="op">=</span> [<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="fl">10.0</span>, <span class="fl">100.0</span>]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    ridge_cv <span class="op">=</span> RidgeCV(alphas<span class="op">=</span>alphas, cv<span class="op">=</span><span class="dv">5</span>).fit(X_subset, y)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Best alpha selected by cross-validation</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    best_alpha <span class="op">=</span> ridge_cv.alpha_</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit Ridge regression with the best alpha</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    ridge_model <span class="op">=</span> Ridge(alpha<span class="op">=</span>best_alpha).fit(X_subset, y)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predictions and performance metrics</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    y_pred_ridge <span class="op">=</span> ridge_model.predict(X_subset)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    ridge_r2 <span class="op">=</span> r2_score(y, y_pred_ridge)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    ridge_mse <span class="op">=</span> mean_squared_error(y, y_pred_ridge)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return coefficients, R^2, MSE, and selected alpha</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    coefficients <span class="op">=</span> pd.DataFrame({</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Variable'</span>: X_subset.columns,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coefficient'</span>: ridge_model.coef_</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> coefficients, ridge_r2, ridge_mse, best_alpha</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Example dataset (assume scaled_data is preprocessed and available)</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"adolescent_fertility"</span>,<span class="st">'Fertility rate, total (births per woman)'</span>,<span class="st">'Year'</span>,<span class="st">'school_enrollment_tertiary'</span>])  <span class="co"># Explanatory variables</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'adolescent_fertility'</span>]</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Define variable inclusion sets</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>variable_sets <span class="op">=</span> [</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'gdp_per_capita'</span>],  <span class="co"># Step 1: GDP per capita only</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'gdp_per_capita'</span>, <span class="st">'school_enrollment_primary'</span>, <span class="st">'school_enrollment_secondary'</span>],  <span class="co"># Step 2: Add school enrollment</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'gdp_per_capita'</span>, <span class="st">'school_enrollment_primary'</span>, <span class="st">'school_enrollment_secondary'</span>, <span class="st">'Region_East Asia &amp; Pacific'</span>, <span class="st">'Region_European Union'</span>,<span class="st">'Region_North America'</span>],  <span class="co"># Step 4: Add another dummy variable</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'gdp_per_capita'</span>, <span class="st">'school_enrollment_primary'</span>, <span class="st">'school_enrollment_secondary'</span>, <span class="st">'Region_East Asia &amp; Pacific'</span>, <span class="st">'Region_European Union'</span>,<span class="st">'Region_North America'</span>,<span class="st">'Year_grouped_1980'</span>,<span class="st">'Year_grouped_1990'</span>,<span class="st">'Year_grouped_2000'</span>, <span class="st">'Year_grouped_2010'</span>,<span class="st">'Year_grouped_2020'</span>],  <span class="co"># Step 5: Add year dummy</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through variable sets and run Ridge regression</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variables <span class="kw">in</span> variable_sets:</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    coefficients, ridge_r2, ridge_mse, best_alpha <span class="op">=</span> run_ridge_with_inclusion(X, y, variables_to_include<span class="op">=</span>variables)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Included Variables'</span>: variables,</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">'R^2'</span>: ridge_r2,</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSE'</span>: ridge_mse,</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Best Alpha'</span>: best_alpha,</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Coefficients'</span>: coefficients</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> result <span class="kw">in</span> results:</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Included Variables: </span><span class="sc">{</span>result[<span class="st">'Included Variables'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"R^2: </span><span class="sc">{</span>result[<span class="st">'R^2'</span>]<span class="sc">:.3f}</span><span class="ss">, MSE: </span><span class="sc">{</span>result[<span class="st">'MSE'</span>]<span class="sc">:.3f}</span><span class="ss">, Best Alpha: </span><span class="sc">{</span>result[<span class="st">'Best Alpha'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Coefficients:"</span>)</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result[<span class="st">'Coefficients'</span>])</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">80</span> <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Included Variables: ['gdp_per_capita']
R^2: 0.225, MSE: 0.775, Best Alpha: 100.0
Coefficients:
         Variable  Coefficient
0  gdp_per_capita    -0.335722

================================================================================

Included Variables: ['gdp_per_capita', 'school_enrollment_primary', 'school_enrollment_secondary']
R^2: 0.851, MSE: 0.149, Best Alpha: 1.0
Coefficients:
                      Variable  Coefficient
0               gdp_per_capita    -0.010159
1    school_enrollment_primary    -0.471573
2  school_enrollment_secondary    -0.587996

================================================================================

Included Variables: ['gdp_per_capita', 'school_enrollment_primary', 'school_enrollment_secondary', 'Region_East Asia &amp; Pacific', 'Region_European Union', 'Region_North America']
R^2: 0.952, MSE: 0.048, Best Alpha: 10.0
Coefficients:
                      Variable  Coefficient
0               gdp_per_capita    -0.186083
1    school_enrollment_primary    -0.316172
2  school_enrollment_secondary    -0.509877
3   Region_East Asia &amp; Pacific    -0.656009
4        Region_European Union    -0.328958
5         Region_North America     0.117550

================================================================================

Included Variables: ['gdp_per_capita', 'school_enrollment_primary', 'school_enrollment_secondary', 'Region_East Asia &amp; Pacific', 'Region_European Union', 'Region_North America', 'Year_grouped_1980', 'Year_grouped_1990', 'Year_grouped_2000', 'Year_grouped_2010', 'Year_grouped_2020']
R^2: 0.958, MSE: 0.042, Best Alpha: 10.0
Coefficients:
                       Variable  Coefficient
0                gdp_per_capita    -0.217385
1     school_enrollment_primary    -0.322671
2   school_enrollment_secondary    -0.516964
3    Region_East Asia &amp; Pacific    -0.648517
4         Region_European Union    -0.294195
5          Region_North America     0.171980
6             Year_grouped_1980     0.000768
7             Year_grouped_1990    -0.009741
8             Year_grouped_2000     0.076593
9             Year_grouped_2010     0.137006
10            Year_grouped_2020     0.067865

================================================================================
</code></pre>
</div>
</div>
<p>After trying different ridge models, the coefficients for regressors do not change significantly.</p>
<ol type="1">
<li>Economic and Educational Factors:</li>
</ol>
<ul>
<li><p>gdp_per_capita (-0.217): A 1-standard-deviation increase in GDP per capita is associated with a 0.217 standard deviation decrease in adolescent fertility. This aligns with the expectation that economic development reduces fertility rates, particularly among adolescents.</p></li>
<li><p>school_enrollment_primary (-0.323) and school_enrollment_secondary (-0.517): Higher enrollment rates in primary and secondary education are strongly associated with lower adolescent fertility rates. Secondary education has a more effect, indicating its critical role in delaying childbearing.</p></li>
</ul>
<ol start="2" type="1">
<li>Regional Effects:</li>
</ol>
<ul>
<li>Region_East Asia &amp; Pacific (-0.649) and Region_European Union (-0.294): Adolescent fertility is significantly lower in these regions compared to Africa Eastern and Southern.</li>
<li>Region_North America (0.172): This positive coefficient indicates slightly higher fertility in North America compared to Africa Eastern and Southern.</li>
</ul>
<ol start="3" type="1">
<li>Temporal Trends</li>
</ol>
<ul>
<li>Year Dummies (Year_grouped_1980 to Year_grouped_2020): The coefficients for year groups are relatively small, indicating gradual changes in fertility over decades. Later years (e.g., 2010, 2020) show positive coefficients compared to earlier years, suggesting slight increases in adolescent fertility over time, though the effects are minimal.</li>
</ul>
</section>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>The findings underscore the critical importance of economic and educational interventions in addressing adolescent fertility, particularly in high-fertility regions. However, several limitations should be noted.</p>
<p>First, the use of grouped year variables may oversimplify temporal changes and miss finer trends within shorter time intervals. Second, multicollinearity among predictors, especially between education and regional variables, could influence the stability of coefficients despite the use of Ridge regression. Third, the exclusion of potentially relevant variables, such as cultural factors or healthcare access, limits the scope of the analysis.</p>
<p>Future studies could address these limitations by incorporating additional predictors, testing interaction effects, and using alternative modeling techniques to further disentangle the complex relationships influencing adolescent fertility. Despite these limitations, the results provide valuable insights for policymakers aiming to reduce adolescent fertility rates through targeted investments in education and economic development.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>